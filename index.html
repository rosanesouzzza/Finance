<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FinanceSystem â€“ MSAL (Popup) + SharePoint (Graph)</title>
  <link rel="stylesheet" href="style.css" />

  <!-- 1) MSAL local (recomendado). Coloque o arquivo em /vendor/msal-browser.min.js -->
  <script src="vendor/msal-browser.min.js"></script>

  <!-- 2) Fallback automÃ¡tico para CDN se o local nÃ£o carregar -->
  <script>
  (function ensureMsal(){
    if (window.msal) return;
    var s = document.createElement('script');
    s.src = "https://cdn.jsdelivr.net/npm/@azure/msal-browser@2.39.0/lib/msal-browser.min.js";
    s.defer = true;
    document.head.appendChild(s);
  })();
  </script>
</head>
<body>
  <div class="container">
    <h1>FinanceSystem â€” ConexÃ£o (MSAL + Graph)</h1>

    <div class="grid">
      <div class="field">
        <label>Tenant ID</label>
        <input id="tenantId" value="d80bf2e9-ace6-421a-86aa-38f9fed30153" />
      </div>

      <div class="field">
        <label>Client ID (App Registration)</label>
        <input id="clientId" value="4de58585-d608-4d47-b7c7-c8ef972e3695" />
      </div>

      <div class="field">
        <label>Site hostname (SharePoint)</label>
        <input id="siteHostname" value="alufran.sharepoint.com" />
      </div>

      <div class="field">
        <label>Site path</label>
        <input id="sitePath" value="/sites/DiretoriaAdministrativa9" />
      </div>

      <div class="field">
        <label>Redirect URI (cadastrada no App como SPA)</label>
        <!-- Para popup nÃ£o Ã© obrigatÃ³rio redirecionar aqui, mas deixe o redirect.html cadastrado no App
             e definido abaixo como fallback/silent token. -->
        <input id="redirectUri" value="https://rosanesouzzza.github.io/Finance/redirect.html" />
      </div>
    </div>

    <div class="actions">
      <button id="btnLogin">ðŸ”‘ Entrar (Popup)</button>
      <button id="btnLogout">ðŸšª Sair</button>
      <button id="btnTest">ðŸ“‹ Testar acesso (listas do site â€“ top 5)</button>
    </div>

    <h3>Log</h3>
    <pre id="log" class="log">Pronto para conectarâ€¦</pre>
  </div>

  <script src="app.js"></script>
</body>
</html>
