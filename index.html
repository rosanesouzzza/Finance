<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FinanceSystem â€“ ConexÃ£o (MSAL + Graph)</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <main class="wrap">
    <h1>FinanceSystem â€“ ConexÃ£o (MSAL + Graph)</h1>

    <section class="card">
      <div class="grid">
        <label>
          <span>Tenant ID</span>
          <input id="tenantId" value="d80bf2e9-ace6-421a-86aa-38f9fed30153">
        </label>
        <label>
          <span>Client ID (App Registration)</span>
          <input id="clientId" value="4de58585-d608-4d47-b7c7-c8ef972e3695">
        </label>
      </div>

      <div class="grid">
        <label>
          <span>Site hostname (SharePoint)</span>
          <input id="siteHost" value="alufran.sharepoint.com">
        </label>
      </div>

      <div class="grid">
        <label>
          <span>Site path</span>
          <input id="sitePath" value="/sites/DiretoriaAdministrativa9">
        </label>
      </div>

      <div class="grid">
        <label class="full">
          <span>Redirect URI (cadastrada no App)</span>
          <input id="redirectUri" readonly>
        </label>
      </div>

      <div class="actions">
        <button id="btnLogin" class="primary">ğŸ” Entrar (Redirect)</button>
        <button id="btnTest" class="ghost">ğŸ“‹ Testar acesso (listas do site â€“ top 5)</button>
        <button id="btnLogout" class="danger">ğŸšª Sair</button>
      </div>

      <small>
        MSAL + Microsoft Graph â€” escopos: <code>openid profile offline_access Sites.ReadWrite.All</code>.
        Se nada abrir ao clicar em Entrar, permita pop-ups para este site (GitHub Pages).
      </small>
    </section>

    <section class="card">
      <h3>Log</h3>
      <pre id="log"></pre>
    </section>
  </main>

  <!-- ORDEM IMPORTA: primeiro MSAL local, depois seu app -->
  <script src="vendor/msal-browser.min.js"></script>
<script src="msal-loader.js"></script>
<script src="app.js"></script>
</body>
</html>

